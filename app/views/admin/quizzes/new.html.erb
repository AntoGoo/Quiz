<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Créer un Quiz</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      body {
        background-color: #f8f9fa;
      }
      .card-header {
        font-weight: bold;
      }
      .question-box {
        background: #e9ecef;
        padding: 20px;
        border-radius: 5px;
      }
      .carousel-control-prev-icon,
      .carousel-control-next-icon {
        background-color:rgb(7, 73, 255); 
        padding: 25px;
        border-radius: 50%;
      }
    </style>
  </head>
  <body>
    <div class="container my-5">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="card shadow">
            <div class="card-header bg-primary text-white text-center">
              <h1 class="mb-0">Créer un Quiz</h1>
            </div>
            <div class="card-body">
              <%= form_with model: @quiz, url: admin_quizzes_path, local: true do |form| %>
                <div class="mb-3">
                  <%= form.label :title, "Titre du quiz", class: "form-label" %>
                  <%= form.text_field :title, class: "form-control", placeholder: "Entrez le titre du quiz" %>
                </div>
                <div class="mb-3">
                  <%= form.label :description, "Description", class: "form-label" %>
                  <%= form.text_area :description, class: "form-control", rows: 3, placeholder: "Ajoutez une courte description du quiz" %>
                </div>

                <h2 class="mt-4 text-center">Ajouter des Questions</h2>

                <!-- Carrousel Bootstrap -->
                <div id="quizCarousel" class="carousel slide" data-bs-ride="false">
                  <div class="carousel-inner">
                    <% @quiz.questions.each_with_index do |question, index| %>
                      <div class="carousel-item <%= "active" if index == 0 %>">
                        <div class="d-flex align-items-center justify-content-center vh-100">
                          <div class="question-box w-75">
                            <h3 class="text-center">Question <%= index + 1 %> </h3>
                            <%= form.fields_for :questions, question do |q_form| %>
                              <div class="mb-4">
                                <%= q_form.label :content, "Texte de la question", class: "form-label" %>
                                <%= q_form.text_field :content, class: "form-control", placeholder: "Entrez la question" %>
                              </div>
                              <h4 class="mt-3 text-center">Réponses possibles :</h4>
                              <% question.options.each do |option| %>
                                <%= q_form.fields_for :options, option do |o_form| %>
                                  <div class="row align-items-center mb-2">
                                    <div class="col-md-8">
                                      <%= o_form.text_field :content, class: "form-control", placeholder: "Réponse" %>
                                    </div>
                                    <div class="col-md-4 text-center">
                                      <%= o_form.check_box :correct, class: "form-check-input" %>
                                      <%= o_form.label :correct, "Bonne réponse ?", class: "form-check-label ms-2" %>
                                    </div>
                                  </div>
                                <% end %>
                              <% end %>
                            <% end %>
                          </div>
                        </div>
                      </div>
                    <% end %>
                  </div>

                  <!-- Flèches de navigation -->
                  <button class="carousel-control-prev" type="button" data-bs-target="#quizCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon"></span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#quizCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon"></span>
                  </button>
                </div>

                <div class="d-grid mt-4">
                  <%= form.submit "Créer le quiz", class: "btn btn-success" %>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Inclusion du JS Bootstrap et activation du carrousel -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        let quizCarousel = new bootstrap.Carousel(document.getElementById("quizCarousel"), {
          interval: false,
          wrap: false
        });
      });
    </script>
  </body>
</html>
